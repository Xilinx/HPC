


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="_static/js/gtm.js"></script>
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="_static/js/linkid.js"></script>
    <script type="text/javascript" src="_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="rst_pcg/pcg_api.html" />
    <link rel="prev" title="C Example using Makefile" href="pcg_c_example.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Xilinx HPC Alveo Products
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Xilinx® Alveo™ HPC Products</a></li>
</ul>
<p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install Xilinx PCG Product</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html#collaborate-on-xilinx-pcg-product">Collaborate on Xilinx PCG Product</a></li>
</ul>
<p class="caption"><span class="caption-text">PCG Solver Example</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pcg_c_example.html">C Example using Makefile</a></li>
</ul>
<p class="caption"><span class="caption-text">Product User Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">PCG Alveo Product User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-the-c-apis">Using the C APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instantiate-an-xjpcg-handle">Instantiate an xJPCG handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#call-the-xjpcg-solver-functions-to-solve-a-system-ax-b">Call the xJPCG solver functions to solve a system <strong>Ax = b</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#destroy-the-xjpcg-handle">Destroy the xJPCG handle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#solving-multiple-systems">Solving Multiple Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#completely-new-coefficient-matrix">Completely new coefficient matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coefficient-matrix-structure-preserved">Coefficient matrix structure preserved</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coefficient-matrix-completely-preserved">Coefficient matrix completely preserved</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linking-your-application">Linking Your Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linking-directly-so">Linking directly (.so)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linking-with-the-dynamic-loader-archive-a">Linking with the dynamic loader archive (.a)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#including-the-dynamic-loader-source-file-c">Including the dynamic loader source file (.c)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xjpcg-api-reference">xJPCG API reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html">Global Namespace</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/HPC/1.0/index.html">1.0</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/HPC/1.1/index.html">1.1</a></li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Note</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="_sources/pcg_userGuide.rst.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Xilinx HPC Alveo Products</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>PCG Alveo Product User Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pcg_userGuide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pcg-alveo-product-user-guide">
<span id="module-guide"></span><h1>PCG Alveo Product User Guide<a class="headerlink" href="#pcg-alveo-product-user-guide" title="Permalink to this headline">¶</a></h1>
<p>The PCG Alveo Product allows you to use a Xilinx Alveo accelerator card to solve a large system of linear equations,
represented by the equation <strong>Ax = b</strong>. In this equation <strong>A</strong> is a sparse coefficient matrix with
potentially millions of rows and columns and millions of non-zero entries, <strong>b</strong> is a dense vector,
and <strong>x</strong> is the dense vector to solve for.</p>
<div class="section" id="using-the-c-apis">
<h2>Using the C APIs<a class="headerlink" href="#using-the-c-apis" title="Permalink to this headline">¶</a></h2>
<p>This section provides a brief overview of the sequence of API function calls your application needs to make.
For more details about function arguments and behavior, please refer to the API Reference.</p>
<p>Follow the steps below to use the APIs.</p>
<ol class="arabic simple">
<li>Instantiate an xJPCG handle</li>
<li>Call xJPCG solver functions to solve a system <strong>Ax = b</strong></li>
<li>Destroy the xJPCG handle</li>
</ol>
<div class="section" id="instantiate-an-xjpcg-handle">
<h3>Instantiate an xJPCG handle<a class="headerlink" href="#instantiate-an-xjpcg-handle" title="Permalink to this headline">¶</a></h3>
<p>To instantiate a xJPCG handle, please call the <code class="docutils literal notranslate"><span class="pre">xJPCG_createHandle()</span></code> function, supplying the device ID of
the Alveo U280 accelerator card installed on your server and the location of the FPGA program file (XCLBIN file).
You can use the <code class="docutils literal notranslate"><span class="pre">xbutil</span> <span class="pre">scan</span></code> command to determine the device ID of the Alveo U280 card. Details about
<code class="docutils literal notranslate"><span class="pre">xbutil</span></code> can be found <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/xbutilutility.html">here</a>.</p>
<pre class="highlight literal-block">
<span></span><span class="c1">#include &quot;pcg.h&quot;</span>

xJPCG_Handle_t* <span class="nv">pHandle</span> <span class="o">=</span> NULL<span class="p">;</span>
int <span class="nv">err</span> <span class="o">=</span> xJPCG_createHandle<span class="o">(</span><span class="p">&amp;</span>pHandle, deviceId, xclbinPath<span class="o">)</span><span class="p">;</span>
</pre>
<p>Creating a handle opens a “session” with the Alveo card. The handle itself is a pointer to the implementation details
for the session.  You can copy the <code class="docutils literal notranslate"><span class="pre">xJPCG_Handle_t</span> <span class="pre">*</span></code> pointer and use both the original and copy to refer to the same
session, but you should not call <code class="docutils literal notranslate"><span class="pre">xJPCG_createHandle()</span></code> twice for the same Alveo card, as the PCG Alveo Product supports
only one session per Alveo card.</p>
</div>
<div class="section" id="call-the-xjpcg-solver-functions-to-solve-a-system-ax-b">
<h3>Call the xJPCG solver functions to solve a system <strong>Ax = b</strong><a class="headerlink" href="#call-the-xjpcg-solver-functions-to-solve-a-system-ax-b" title="Permalink to this headline">¶</a></h3>
<p>The PCG Alveo Product provides two xJPCG solver functions to cater for different matrix storage formats.
If the matrix is stored in <strong>COO</strong> format, please use the <code class="docutils literal notranslate"><span class="pre">xJPCG_cooSolver()</span></code> function.
If the matrix is stored in <strong>CSC</strong> format and only the top or bottom triangular part of the matrix is stored,
please use the <code class="docutils literal notranslate"><span class="pre">xJPCG_cscSymSolver()</span></code> function. Detailed information about <strong>COO</strong> and <strong>CSC</strong>
sparse matrix storage formats can be found <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_matrix">here</a>.</p>
<pre class="highlight literal-block">
<span></span>int <span class="nv">err</span> <span class="o">=</span> xJPCG_cooSolver<span class="o">(</span>pHandle, n, nnz, rowIdx, colIdx, data, matJ, b, x, maxIter, tol,
                                     <span class="p">&amp;</span>iter, <span class="p">&amp;</span>res,  XJPCG_MODE_DEFAULT<span class="o">)</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="destroy-the-xjpcg-handle">
<h3>Destroy the xJPCG handle<a class="headerlink" href="#destroy-the-xjpcg-handle" title="Permalink to this headline">¶</a></h3>
<p>When you have finished solving systems, please call the <code class="docutils literal notranslate"><span class="pre">xJPCG_destroyHandle()</span></code> function to release all resources used
by the product.</p>
</div>
</div>
<div class="section" id="solving-multiple-systems">
<h2>Solving Multiple Systems<a class="headerlink" href="#solving-multiple-systems" title="Permalink to this headline">¶</a></h2>
<p>In your application you may need to solve multiple systems in sequence. To maximize performance by reusing
coefficient matrix data, the solver functions support three reuse scenarios, listed below.  In these scenarios,
“previous system” refers to the data passed to the most recent solver function call, while “current system”
refers to a new solver function call.  For data reuse to succeed, you must make both function calls in the same session
(that is, with the same xJPCG handle).</p>
<ol class="arabic simple">
<li><strong>Completely new coefficient matrix</strong>: The coefficient matrix of the current system is completely different
from that of the previous system. That is, both the indices and NNZ (non-zero) values in the coefficient matrix
are different.</li>
<li><strong>Coefficient matrix structure preserved</strong>: The coefficient matrix of the current system has the same structure
(that is, the same indices) as that of the previous system, but the NNZ values are different.</li>
<li><strong>Coefficient matrix completely preserved</strong>: The coefficient matrix of the current system is identical to that
of the previous one.</li>
</ol>
<p>The following subsections show you how to use the solver functions for multiple runs in each reuse scenario.
In each of these scenarios the solver function is called twice: once for the first call of a session and a second
time to demonstrate the reuse.  Input arguments in <strong>bold</strong> indicate values that have changed from the first call to the
second.  The remaining input arguments have values which are identical between the two calls.</p>
<p>Note that you must pass the coefficient matrix to the second solver function call even if the matrix is unchanged.
Also, the <strong>b</strong> vector is free to change with every solver function call.</p>
<div class="section" id="completely-new-coefficient-matrix">
<h3>Completely new coefficient matrix<a class="headerlink" href="#completely-new-coefficient-matrix" title="Permalink to this headline">¶</a></h3>
<p>When completely replacing the coefficient matrix in the second call, use the <code class="docutils literal notranslate"><span class="pre">XJPCG_MODE_DEFAULT</span></code> option, as
shown below.</p>
<pre>
int err = xJPCG_cooSolver(pHandle, n1, nnz1, rowIdx1, colIdx1, data1, matJ1, b1, x1, maxIter, tol,
                                     &iter1, &res1,  XJPCG_MODE_DEFAULT);

int err = xJPCG_cooSolver(pHandle, <b>n2</b>, <b>nnz2</b>, <b>rowIdx2</b>, <b>colIdx2</b>, <b>data2</b>, <b>matJ2</b>, <b>b2</b>, x2, maxIter, tol,
                                     &iter2, &res2,  XJPCG_MODE_DEFAULT);
</pre></div>
<div class="section" id="coefficient-matrix-structure-preserved">
<h3>Coefficient matrix structure preserved<a class="headerlink" href="#coefficient-matrix-structure-preserved" title="Permalink to this headline">¶</a></h3>
<p>When replacing the coefficient matrix’s values while keeping the matrix’s structure (indices) in the second call,
use the <code class="docutils literal notranslate"><span class="pre">XJPCG_MODE_KEEP_NZ_LAYOUT</span></code> option, as shown below.</p>
<pre class="highlight literal-block">
<span></span>int <span class="nv">err</span> <span class="o">=</span> xJPCG_cooSolver<span class="o">(</span>pHandle, n1, nnz1, rowIdx1, colIdx1, data1, matJ1, b1, x1, maxIter, tol,
                                     <span class="p">&amp;</span>iter1, <span class="p">&amp;</span>res1,  XJPCG_MODE_DEFAULT<span class="o">)</span><span class="p">;</span>

int <span class="nv">err</span> <span class="o">=</span> xJPCG_cooSolver<span class="o">(</span>pHandle, n1, nnz1, rowIdx1, colIdx1, data2, matJ2, b2, x2, maxIter, tol,
                                     <span class="p">&amp;</span>iter2, <span class="p">&amp;</span>res2,  XJPCG_MODE_KEEP_NZ_LAYOUT<span class="o">)</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="coefficient-matrix-completely-preserved">
<h3>Coefficient matrix completely preserved<a class="headerlink" href="#coefficient-matrix-completely-preserved" title="Permalink to this headline">¶</a></h3>
<p>When retaining the entire cofficient matrix for the second call, including both structure (indices) and non-zero
values, use the <code class="docutils literal notranslate"><span class="pre">XJPCG_MODE_KEEP_MATRIX</span></code> option, as shown below.</p>
<pre class="highlight literal-block">
<span></span>int <span class="nv">err</span> <span class="o">=</span> xJPCG_cooSolver<span class="o">(</span>pHandle, n1, nnz1, rowIdx1, colIdx1, data1, matJ1, b1, x1, maxIter, tol,
                                     <span class="p">&amp;</span>iter1, <span class="p">&amp;</span>res1,  XJPCG_MODE_DEFAULT<span class="o">)</span><span class="p">;</span>

int <span class="nv">err</span> <span class="o">=</span> xJPCG_cooSolver<span class="o">(</span>pHandle, n1, nnz1, rowIdx1, colIdx1, data1, matJ1, b2, x2, maxIter, tol,
                                     <span class="p">&amp;</span>iter1, <span class="p">&amp;</span>res1,  XJPCG_MODE_KEEP_MATRIX<span class="o">)</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h2>
<p>Most of the API functions return a status code of enumeration type <code class="docutils literal notranslate"><span class="pre">XJPCG_Status_t</span></code>.  Successful function calls
return enumerator <code class="docutils literal notranslate"><span class="pre">XJPCG_STATUS_SUCCESS</span></code>.  All other returned enumerators indicate an error, for which you can
retrieve a detailed error message with the <code class="docutils literal notranslate"><span class="pre">xJPCG_getLastMessage()</span></code> function.  You can also retrieve the status code
of the most recent failure with the <code class="docutils literal notranslate"><span class="pre">xJPCG_peekAtLastStatus()</span></code> function.</p>
<p>Both error retrieval functions take a handle pointer to fetch the most recent error for that handle.  For most types
of errors, the handle pointer must be valid, except for dynamic loading errors (see the next section, <cite>Linking Your
Application</cite>), which disregard the handle pointer, as those errors are global.  Note that the <code class="docutils literal notranslate"><span class="pre">xJPCG_createHandle()</span></code>
function returns a valid handle to use with error retrieval functions even if initialization failed.</p>
</div>
<div class="section" id="linking-your-application">
<h2>Linking Your Application<a class="headerlink" href="#linking-your-application" title="Permalink to this headline">¶</a></h2>
<p>You have a few choices for how to link the API code into your application:</p>
<ul class="simple">
<li>Linking directly with the PCG shared library (.so)</li>
<li>Linking with the PCG dynamic loader archive (.a)</li>
<li>Including the PCG dynamic loader source file (.c)</li>
</ul>
<div class="section" id="linking-directly-so">
<h3>Linking directly (.so)<a class="headerlink" href="#linking-directly-so" title="Permalink to this headline">¶</a></h3>
<p>The simplest method of linking the API into your application is to link directly with the shared library (.so),
placing a run-time dependency of your application on the shared library.  Simply add the following arguments to
your link line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">xilinx</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">hpc</span><span class="o">/</span><span class="n">pcg</span><span class="o">/&lt;</span><span class="n">version</span><span class="o">&gt;/</span><span class="n">lib</span> <span class="o">-</span><span class="n">lXilinxPcg</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> is the version of the PCG Alveo Product.</p>
</div>
<div class="section" id="linking-with-the-dynamic-loader-archive-a">
<h3>Linking with the dynamic loader archive (.a)<a class="headerlink" href="#linking-with-the-dynamic-loader-archive-a" title="Permalink to this headline">¶</a></h3>
<p>To avoid having a run-time dependency on the shared library, but instead load the shared library on demand
(internally using <code class="docutils literal notranslate"><span class="pre">dlopen()</span></code>), you can link with the loader archive by adding the following arguments to
your link line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">xilinx</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">hpc</span><span class="o">/</span><span class="n">pcg</span><span class="o">/&lt;</span><span class="n">version</span><span class="o">&gt;/</span><span class="n">lib</span> <span class="o">-</span><span class="n">lXilinxPcg_loader</span> <span class="o">-</span><span class="n">ldl</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> is the version of the PCG Alveo Product.</p>
</div>
<div class="section" id="including-the-dynamic-loader-source-file-c">
<h3>Including the dynamic loader source file (.c)<a class="headerlink" href="#including-the-dynamic-loader-source-file-c" title="Permalink to this headline">¶</a></h3>
<p>Another way to avoid a run-time dependency on the shared library is by including the loader source file in
a header or source file of your program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#define XILINX_PCG_INLINE_IMPL</span>
<span class="c1">#include &quot;pcg.h&quot;</span>

<span class="o">//</span> <span class="n">Code</span> <span class="n">that</span> <span class="n">uses</span> <span class="n">the</span> <span class="n">API</span> <span class="n">goes</span> <span class="n">here</span>

<span class="c1">#include &quot;pcg_loader.c&quot;</span>
</pre></div>
</div>
<p>Note that you will still have to include <code class="docutils literal notranslate"><span class="pre">-ldl</span></code> on your link line to pull in the standard dynamic loading library.</p>
<p>The loader source file is located in <code class="docutils literal notranslate"><span class="pre">/opt/xilinx/apps/hpc/pcg/&lt;version&gt;/src</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> is the version
of the PCG Alveo Product.  Note the macro definition that comes before the inclusion of <code class="docutils literal notranslate"><span class="pre">pcg.h</span></code>.</p>
<p><em>TIP:*</em> When using either dynamic loading technique, if the order of symbol loading causes unexplained behavior in
your application, you can try adding <code class="docutils literal notranslate"><span class="pre">libXilinxPcgStatic.so</span></code> to the list of pre-loaded shared libraries,
as explained in <a class="reference external" href="https://stackoverflow.com/questions/426230/what-is-the-ld-preload-trick">this article</a>.</p>
</div>
</div>
<div class="section" id="xjpcg-api-reference">
<h2>xJPCG API reference<a class="headerlink" href="#xjpcg-api-reference" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="rst_pcg/global.html">Global Namespace</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rst_pcg/global.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#typedefs">Typedefs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rst_pcg/global.html#global-functions">Global Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-geterrorstring">xJPCG_getErrorString</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-createhandle">xJPCG_createHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-destroyhandle">xJPCG_destroyHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-cscsymsolver">xJPCG_cscSymSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-coosolver">xJPCG_cooSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-peekatlaststatus">xJPCG_peekAtLastStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-getlastmessage">xJPCG_getLastMessage</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#xjpcg-getmetrics">xJPCG_getMetrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="rst_pcg/global.html#macros">Macros</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rst_pcg/pcg_api.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pcg_c_example.html" class="btn btn-neutral float-left" title="C Example using Makefile" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2021, Xilinx Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>