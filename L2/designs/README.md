# Overview

Each leaf directory, e.g. fcn_sigmoid_3cu_azure, contains all information needed to build and test an accelerator for a specific Xilinx Alveo platform. Please follow the instructions in the following text to build and test the accelerator you are interested.

## Prerequisites

- Vitis libraries are required to build the accelerators designs here
- This repository, namely, Xilinx/HPC repository is required to build the customized HPC accelerators and applications
- Xilinx runtime (XRT) is required to build and run the host code to test the implemented accelerator
- Xilinx Vitis 2021.1 installed and configured. Xilinx Vitis 2021.1 is required to build the accelerator

## Building

Here are common steps requried for building an accelerator. To run the accelerators on Azure cloud platform, please attest the generated .xclbin file, which is the hardware logic for the FPGA, to generate a working azure.xclbin first.

### Download code

Please follow the steps below to download Xilinx HPC and Vitis_Libraries.

```
    git clone https://github.com/Xilinx/HPC.git
    git clone https://github.com/Xilinx/Vitis_Libraries
``` 

### Setup environment

If you want to build the .xclbin/accelerator from the individual directory here, please install Xilinx Vitis, and set up the Vitis environment by running:

```
    source <install_path>/installs/lin64/Vitis/2021.1/settings64.sh
    export PLATFORM_REPO_PATHS=/opt/xilinx/platforms
```
To compile and run host code for testing the accelerator, please set up the Xilinx XRT environment via following instructions.

```
    source /opt/xilinx/xrt/setup.sh
```

### Build accelerator

Please navigate to the accelerator folder, e.g. L2/designs/mlp/fcn_sigmoid_3cu_azure, and run following make command.

```
    make build TARGET=hw
```

### Build host code for testing the accelerator

Please navigate to the accelerator folder, e.g. L2/designs/mlp/fcn_sigmoid_3cu_azure, and run following make command.

```
    make host TARGET=hw
```

### Test the accelerator

Please navigate to the accelerator folder, e.g. L2/designs/mlp/fcn_sigmoid_3cu_azure, and run following make command.

```
    make run TARGET=hw
```

### Clean up the intermediate results

To clean up the intermediate results, or the data generated by the previous make command, please navigate to the accelerator folder
and run the following make command.

```
    make cleanall
```
